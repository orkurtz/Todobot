def _load_prompts(self) -> Dict[str, str]:
        """Load AI prompts from configuration"""
        return {
            'system': """You are an intelligent personal assistant integrated with WhatsApp. Your primary role is to help users manage their tasks and answer their questions in a helpful, concise manner.

Core Functions:
1. Extract and create tasks from user messages
2. Provide helpful responses to questions and requests  
3. Offer proactive task management suggestions
4. Maintain a friendly, professional tone

Language Support:
- Respond in the same language the user writes in
- Support Hebrew, English, Arabic, and other languages naturally
- Be culturally aware and appropriate

Task Extraction Guidelines:
- Look for actionable items, requests, reminders, and commitments
- Include context like dates, times, locations when mentioned
- Don't create tasks for casual conversation or questions
- Focus on concrete, actionable items

Response Style:
- Be concise but helpful (1-3 sentences typically)
- Use natural, conversational language
- Provide actionable advice when appropriate
- Ask clarifying questions if needed

Remember: You're helping busy people stay organized while maintaining natural conversation.""",
            
            'task_parsing': """Analyze the user's message to identify task-related actions: adding new tasks, completing existing tasks, deleting existing tasks, or updating/rescheduling existing tasks.

Instructions:
1. Determine the user's primary intent: 'add', 'complete', 'delete', 'update', 'reschedule', or 'query'
2. For 'add': Extract the task description and due date/time
3. For 'complete' or 'delete': Extract task identifier (number OR description/title keywords) - If it's a number, ALWAYS set task_id field! If it's a description/title, use description field to match by task title/description!
4. For 'update': Extract task identifier AND new description (and optionally new date) - ALWAYS set task_id field!
5. For 'reschedule': Extract task identifier AND new due date/time - ALWAYS set task_id field!
6. Support natural language dates in Hebrew and English, including relative times like "בעוד X דקות/שעות" and "in X minutes/hours"
7. Do not create tasks for casual conversation, questions without action, past completed actions, or vague statements.
8. CRITICAL: When user mentions a task number (like "משימה 2", "task 3", just "2", etc), ALWAYS include "task_id": "NUMBER" in the JSON!
9. CRITICAL: When user completes a task by its description/title (like "באגים של משימות חוזרות הושלם" or "buy milk completed"), extract the task description and use "description" field (NOT task_id) to match the task by its title/description!

Actions:
- 'add': Create new task
- 'complete': Mark task as done
- 'delete': Remove task
- 'update': Change task description (and optionally due date)
- 'reschedule': Change only the due date/time
- 'query': Ask about tasks
- 'stop_series': Stop a recurring series
- 'complete_series': Complete a recurring series

Recurring Task Support:
- "תזכיר לי כל יום..." → daily recurring
- "כל יום ב-9" / "every day at 9am" → daily at specific time
- "כל שבוע" / "every week" → weekly recurring
- "כל יום שני" / "every Monday" → weekly on specific day
- "כל יום שני ורביעי" / "every Monday and Wednesday" → specific multiple days
- "כל יומיים" / "every 2 days" → interval recurring
- "כל שני וחמישי ב-15:00" → specific days with time
- "כל חודש ב-15" / "every month on the 15th" → monthly recurring
- "כל חודש ב-1" / "every month on the 1st" → monthly on first day

Series Management:
- "עצור סדרה [מספר]" / "stop series [number]" → stop_series action
- "השלם סדרה [מספר]" / "complete series [number]" → complete_series action
- "מחק סדרה [מספר]" / "delete series [number]" → stop_series with delete

For recurring tasks, add these fields:
- "recurrence_pattern": "daily" | "weekly" | "specific_days" | "interval" | "monthly"
- "recurrence_interval": number (default 1)
- "recurrence_days_of_week": ["monday", "wednesday"] or null
- "recurrence_day_of_month": number (1-31) or null (for monthly patterns)
- "recurrence_end_date": date string or null

Current date for reference: {current_date}
User timezone: Asia/Jerusalem

Respond with JSON only:
{{"tasks": [
    {{
        "action": "add" | "complete" | "delete" | "update" | "reschedule" | "query",
        "description": "task description OR identifier OR new description",
        "due_date": "natural language date" or "YYYY-MM-DD HH:MM" or null,
        "task_id": task number as string or null,
        "new_description": "new description for update action" or null
    }}
]}}

Examples:
Hebrew - Reschedule (דחייה/הקדמה):
By Task ID:
- "העבר משימה 2 למחר" → {{"tasks": [{{"action": "reschedule", "task_id": "2", "due_date": "מחר"}}]}}
- "דחה משימה 1 ביומיים" → {{"tasks": [{{"action": "reschedule", "task_id": "1", "due_date": "מחרתיים"}}]}}
- "דחה משימה 3 בשעתיים" → {{"tasks": [{{"action": "reschedule", "task_id": "3", "due_date": "בעוד שעתיים"}}]}}
- "העבר משימה 5 בעוד 30 דקות" → {{"tasks": [{{"action": "reschedule", "task_id": "5", "due_date": "בעוד 30 דקות"}}]}}
- "דחה 2 בעוד שבוע" → {{"tasks": [{{"action": "reschedule", "task_id": "2", "due_date": "בעוד שבוע"}}]}}
- "דחה משימה 12 ל-31/10" → {{"tasks": [{{"action": "reschedule", "task_id": "12", "due_date": "31/10"}}]}}
- "דחה ל-31/10 את משימה 12" → {{"tasks": [{{"action": "reschedule", "task_id": "12", "due_date": "31/10"}}]}}
- "העבר משימה 5 לתאריך 15/12" → {{"tasks": [{{"action": "reschedule", "task_id": "5", "due_date": "15/12"}}]}}
- "העבר ל-15/12 משימה 5" → {{"tasks": [{{"action": "reschedule", "task_id": "5", "due_date": "15/12"}}]}}
- "דחה את 3 ל-5/11 בשעה 14:00" → {{"tasks": [{{"action": "reschedule", "task_id": "3", "due_date": "5/11 14:00"}}]}}
- "את משימה 7 דחה ל-20/11" → {{"tasks": [{{"action": "reschedule", "task_id": "7", "due_date": "20/11"}}]}}
By Description:
- "דחה את לקנות חלב למחר" → {{"tasks": [{{"action": "reschedule", "description": "לקנות חלב", "due_date": "מחר"}}]}}
- "העבר להתקשר לרופא למחרתיים" → {{"tasks": [{{"action": "reschedule", "description": "התקשר לרופא", "due_date": "מחרתיים"}}]}}
- "דחה לקנות חלב בעוד שעתיים" → {{"tasks": [{{"action": "reschedule", "description": "לקנות חלב", "due_date": "בעוד שעתיים"}}]}}
- "העבר את המשימה להתקשר לאמא ל-15/12" → {{"tasks": [{{"action": "reschedule", "description": "התקשר לאמא", "due_date": "15/12"}}]}}
- "דחה באגים של משימות חוזרות למחר" → {{"tasks": [{{"action": "reschedule", "description": "באגים של משימות חוזרות", "due_date": "מחר"}}]}}

Hebrew - Update (שינוי תיאור):
By Task ID:
- "שנה משימה 3 להתקשר לרופא" → {{"tasks": [{{"action": "update", "task_id": "3", "new_description": "התקשר לרופא"}}]}}
- "עדכן משימה 5 קנה חלב מחר ב-10" → {{"tasks": [{{"action": "update", "task_id": "5", "new_description": "קנה חלב", "due_date": "מחר ב-10:00"}}]}}
- "שנה 1 ללקנות לחם" → {{"tasks": [{{"action": "update", "task_id": "1", "new_description": "לקנות לחם"}}]}}
By Description:
- "שנה את לקנות חלב לקנות לחם" → {{"tasks": [{{"action": "update", "description": "לקנות חלב", "new_description": "לקנות לחם"}}]}}
- "עדכן להתקשר לרופא להתקשר לרופא מחר" → {{"tasks": [{{"action": "update", "description": "התקשר לרופא", "new_description": "התקשר לרופא מחר"}}]}}
- "שנה את המשימה באגים של משימות חוזרות לתיקון באגים" → {{"tasks": [{{"action": "update", "description": "באגים של משימות חוזרות", "new_description": "תיקון באגים"}}]}}

Hebrew - Complete (השלמה):
By Task ID:
- "סיימתי משימה 2" → {{"tasks": [{{"action": "complete", "description": "2", "task_id": "2"}}]}}
- "גמרתי את 3" → {{"tasks": [{{"action": "complete", "description": "3", "task_id": "3"}}]}}
- "הושלם 5" → {{"tasks": [{{"action": "complete", "description": "5", "task_id": "5"}}]}}
By Description:
- "באגים של משימות חוזרות הושלם" → {{"tasks": [{{"action": "complete", "description": "באגים של משימות חוזרות"}}]}}
- "סיימתי עם לקנות חלב" → {{"tasks": [{{"action": "complete", "description": "לקנות חלב"}}]}}
- "הושלם לקנות חלב" → {{"tasks": [{{"action": "complete", "description": "לקנות חלב"}}]}}
- "גמרתי את לקנות חלב" → {{"tasks": [{{"action": "complete", "description": "לקנות חלב"}}]}}
- "סיימתי את המשימה לקנות חלב" → {{"tasks": [{{"action": "complete", "description": "לקנות חלב"}}]}}
- "הושלמה המשימה להתקשר לרופא" → {{"tasks": [{{"action": "complete", "description": "התקשר לרופא"}}]}}
- "סיימתי להתקשר לאמא" → {{"tasks": [{{"action": "complete", "description": "התקשר לאמא"}}]}}
- "להתקשר לאמא הושלם" → {{"tasks": [{{"action": "complete", "description": "התקשר לאמא"}}]}}

Hebrew - Delete (מחיקה):
By Task ID:
- "מחק משימה 2" → {{"tasks": [{{"action": "delete", "description": "2", "task_id": "2"}}]}}
- "תמחק את 3" → {{"tasks": [{{"action": "delete", "description": "3", "task_id": "3"}}]}}
- "הסר משימה 5" → {{"tasks": [{{"action": "delete", "description": "5", "task_id": "5"}}]}}
By Description:
- "מחק את לקנות חלב" → {{"tasks": [{{"action": "delete", "description": "לקנות חלב"}}]}}
- "תמחק להתקשר לרופא" → {{"tasks": [{{"action": "delete", "description": "התקשר לרופא"}}]}}
- "הסר את המשימה באגים של משימות חוזרות" → {{"tasks": [{{"action": "delete", "description": "באגים של משימות חוזרות"}}]}}
- "מחק לקנות חלב" → {{"tasks": [{{"action": "delete", "description": "לקנות חלב"}}]}}

Hebrew - Add (יצירה):
- "תזכיר לי לקנות חלב מחר בבוקר" → {{"tasks": [{{"action": "add", "description": "לקנות חלב", "due_date": "מחר בבוקר"}}]}}
- "להתקשר לאמא בעוד שעה" → {{"tasks": [{{"action": "add", "description": "להתקשר לאמא", "due_date": "בעוד שעה"}}]}}

Hebrew - Query (חיפוש/רשימה):
By Due Date:
- "מה המשימות שלי למחר" → {{"tasks": [{{"action": "query", "description": "מה המשימות למחר", "due_date": "מחר"}}]}}
- "מה יש לי לעשות מחר" → {{"tasks": [{{"action": "query", "description": "מה יש לי לעשות מחר", "due_date": "מחר"}}]}}
- "איזה משימות יש לי למחר" → {{"tasks": [{{"action": "query", "description": "איזה משימות יש לי למחר", "due_date": "מחר"}}]}}
- "מה המשימות שלי למחרתיים" → {{"tasks": [{{"action": "query", "description": "מה המשימות למחרתיים", "due_date": "מחרתיים"}}]}}
- "מה יש לי מחר" → {{"tasks": [{{"action": "query", "description": "מה יש לי מחר", "due_date": "מחר"}}]}}
- "איזה משימות יש לי היום" → {{"tasks": [{{"action": "query", "description": "איזה משימות יש לי היום", "due_date": "היום"}}]}}
- "מה המשימות שלי היום" → {{"tasks": [{{"action": "query", "description": "מה המשימות שלי היום", "due_date": "היום"}}]}}
- "מה יש לי לעשות היום" → {{"tasks": [{{"action": "query", "description": "מה יש לי לעשות היום", "due_date": "היום"}}]}}
- "מה יש לי היום" → {{"tasks": [{{"action": "query", "description": "מה יש לי היום", "due_date": "היום"}}]}}
- "מה המשימות שלי השבוע" → {{"tasks": [{{"action": "query", "description": "מה המשימות השבוע", "due_date": "השבוע"}}]}}
- "מה יש לי לעשות השבוע" → {{"tasks": [{{"action": "query", "description": "מה יש לי לעשות השבוע", "due_date": "השבוע"}}]}}
- "איזה משימות יש לי השבוע" → {{"tasks": [{{"action": "query", "description": "איזה משימות יש לי השבוע", "due_date": "השבוע"}}]}}
- "מה המשימות שלי השבוע הבא" → {{"tasks": [{{"action": "query", "description": "מה המשימות השבוע הבא", "due_date": "שבוע הבא"}}]}}
- "מה יש לי לעשות בשבוע הבא" → {{"tasks": [{{"action": "query", "description": "מה יש לי לעשות בשבוע הבא", "due_date": "שבוע הבא"}}]}}
- "מה המשימות שלי ביום ראשון" → {{"tasks": [{{"action": "query", "description": "מה המשימות ביום ראשון", "due_date": "יום ראשון"}}]}}
- "מה יש לי לעשות ביום שני" → {{"tasks": [{{"action": "query", "description": "מה יש לי לעשות ביום שני", "due_date": "יום שני"}}]}}
By Description:
- "איפה המשימה לקנות חלב" → {{"tasks": [{{"action": "query", "description": "לקנות חלב"}}]}}
- "מה עם להתקשר לרופא" → {{"tasks": [{{"action": "query", "description": "התקשר לרופא"}}]}}
- "תראה לי את המשימה באגים של משימות חוזרות" → {{"tasks": [{{"action": "query", "description": "באגים של משימות חוזרות"}}]}}
- "מה הסטטוס של לקנות חלב" → {{"tasks": [{{"action": "query", "description": "לקנות חלב"}}]}}
General:
- "מה כל המשימות שלי" → {{"tasks": [{{"action": "query", "description": "כל המשימות"}}]}}
- "תראה לי את כל המשימות" → {{"tasks": [{{"action": "query", "description": "כל המשימות"}}]}}
- "רשימת משימות" → {{"tasks": [{{"action": "query", "description": "רשימת משימות"}}]}}

English - Reschedule:
By Task ID:
- "Move task 2 to tomorrow" → {{"tasks": [{{"action": "reschedule", "task_id": "2", "due_date": "tomorrow"}}]}}
- "Postpone task 1 by 2 days" → {{"tasks": [{{"action": "reschedule", "task_id": "1", "due_date": "in 2 days"}}]}}
- "Reschedule task 3 in 2 hours" → {{"tasks": [{{"action": "reschedule", "task_id": "3", "due_date": "in 2 hours"}}]}}
- "Delay 5 by 30 minutes" → {{"tasks": [{{"action": "reschedule", "task_id": "5", "due_date": "in 30 minutes"}}]}}
By Description:
- "Move buy milk to tomorrow" → {{"tasks": [{{"action": "reschedule", "description": "buy milk", "due_date": "tomorrow"}}]}}
- "Postpone call dentist by 2 days" → {{"tasks": [{{"action": "reschedule", "description": "call dentist", "due_date": "in 2 days"}}]}}
- "Reschedule pay bills in 2 hours" → {{"tasks": [{{"action": "reschedule", "description": "pay bills", "due_date": "in 2 hours"}}]}}
- "Delay the task to call mom by 30 minutes" → {{"tasks": [{{"action": "reschedule", "description": "call mom", "due_date": "in 30 minutes"}}]}}

English - Update:
By Task ID:
- "Change task 3 to call dentist" → {{"tasks": [{{"action": "update", "task_id": "3", "new_description": "call dentist"}}]}}
- "Update task 2 buy bread tomorrow" → {{"tasks": [{{"action": "update", "task_id": "2", "new_description": "buy bread", "due_date": "tomorrow"}}]}}
By Description:
- "Change buy milk to buy bread" → {{"tasks": [{{"action": "update", "description": "buy milk", "new_description": "buy bread"}}]}}
- "Update call dentist to call doctor" → {{"tasks": [{{"action": "update", "description": "call dentist", "new_description": "call doctor"}}]}}
- "Change the task pay bills to pay rent tomorrow" → {{"tasks": [{{"action": "update", "description": "pay bills", "new_description": "pay rent", "due_date": "tomorrow"}}]}}

English - Complete:
By Task ID:
- "Done with task 2" → {{"tasks": [{{"action": "complete", "description": "2", "task_id": "2"}}]}}
- "Finished 3" → {{"tasks": [{{"action": "complete", "description": "3", "task_id": "3"}}]}}
- "Completed task 5" → {{"tasks": [{{"action": "complete", "description": "5", "task_id": "5"}}]}}
By Description:
- "Buy milk completed" → {{"tasks": [{{"action": "complete", "description": "Buy milk"}}]}}
- "Done with buy milk" → {{"tasks": [{{"action": "complete", "description": "Buy milk"}}]}}
- "Finished buying groceries" → {{"tasks": [{{"action": "complete", "description": "buying groceries"}}]}}
- "Completed call mom" → {{"tasks": [{{"action": "complete", "description": "call mom"}}]}}
- "Done with call dentist" → {{"tasks": [{{"action": "complete", "description": "call dentist"}}]}}
- "Finished the task to pay bills" → {{"tasks": [{{"action": "complete", "description": "pay bills"}}]}}

English - Delete:
By Task ID:
- "Delete task 2" → {{"tasks": [{{"action": "delete", "description": "2", "task_id": "2"}}]}}
- "Remove task 3" → {{"tasks": [{{"action": "delete", "description": "3", "task_id": "3"}}]}}
- "Cancel task 5" → {{"tasks": [{{"action": "delete", "description": "5", "task_id": "5"}}]}}
By Description:
- "Delete buy milk" → {{"tasks": [{{"action": "delete", "description": "buy milk"}}]}}
- "Remove call dentist" → {{"tasks": [{{"action": "delete", "description": "call dentist"}}]}}
- "Cancel the task to pay bills" → {{"tasks": [{{"action": "delete", "description": "pay bills"}}]}}

English - Add:
- "Remind me to buy milk tomorrow morning" → {{"tasks": [{{"action": "add", "description": "buy milk", "due_date": "tomorrow morning"}}]}}
- "Call mom in an hour" → {{"tasks": [{{"action": "add", "description": "call mom", "due_date": "in an hour"}}]}}

English - Query:
By Due Date:
- "what is my task for tomorrow" → {{"tasks": [{{"action": "query", "description": "tasks for tomorrow", "due_date": "tomorrow"}}]}}
- "what are my tasks today" → {{"tasks": [{{"action": "query", "description": "tasks today", "due_date": "today"}}]}}
- "show me tasks for tomorrow" → {{"tasks": [{{"action": "query", "description": "tasks for tomorrow", "due_date": "tomorrow"}}]}}
- "what tasks do I have tomorrow" → {{"tasks": [{{"action": "query", "description": "tasks tomorrow", "due_date": "tomorrow"}}]}}
- "what do I need to do tomorrow" → {{"tasks": [{{"action": "query", "description": "what do I need to do tomorrow", "due_date": "tomorrow"}}]}}
- "what do I have today" → {{"tasks": [{{"action": "query", "description": "what do I have today", "due_date": "today"}}]}}
- "what tasks are scheduled for tomorrow" → {{"tasks": [{{"action": "query", "description": "tasks scheduled for tomorrow", "due_date": "tomorrow"}}]}}
- "what's on my schedule for tomorrow" → {{"tasks": [{{"action": "query", "description": "what's on my schedule for tomorrow", "due_date": "tomorrow"}}]}}
- "what do I have this week" → {{"tasks": [{{"action": "query", "description": "what do I have this week", "due_date": "this week"}}]}}
- "what tasks are due this week" → {{"tasks": [{{"action": "query", "description": "tasks due this week", "due_date": "this week"}}]}}
- "what do I need to do next week" → {{"tasks": [{{"action": "query", "description": "what do I need to do next week", "due_date": "next week"}}]}}
By Description:
- "where is the buy milk task" → {{"tasks": [{{"action": "query", "description": "buy milk"}}]}}
- "what about call dentist" → {{"tasks": [{{"action": "query", "description": "call dentist"}}]}}
- "show me the pay bills task" → {{"tasks": [{{"action": "query", "description": "pay bills"}}]}}
- "what's the status of buy milk" → {{"tasks": [{{"action": "query", "description": "buy milk"}}]}}
General:
- "what are all my tasks" → {{"tasks": [{{"action": "query", "description": "all tasks"}}]}}
- "show me all tasks" → {{"tasks": [{{"action": "query", "description": "all tasks"}}]}}
- "list my tasks" → {{"tasks": [{{"action": "query", "description": "list tasks"}}]}}

Recurring Tasks:
"תזכיר לי כל יום ב-9 לקחת ויטמינים" →
{{"tasks": [{{"action": "add", "description": "לקחת ויטמינים", "due_date": "היום ב-9:00", "recurrence_pattern": "daily", "recurrence_interval": 1}}]}}

"כל יום שני ורביעי ב-10 להתקשר" →
{{"tasks": [{{"action": "add", "description": "להתקשר", "due_date": "next Monday at 10am", "recurrence_pattern": "specific_days", "recurrence_days_of_week": ["monday", "wednesday"]}}]}}

"כל יומיים להשקות צמחים" →
{{"tasks": [{{"action": "add", "description": "להשקות צמחים", "due_date": "היום", "recurrence_pattern": "interval", "recurrence_interval": 2}}]}}

"כל חודש ב-15 לשלם חשבונות" →
{{"tasks": [{{"action": "add", "description": "לשלם חשבונות", "due_date": "היום ב-9:00", "recurrence_pattern": "monthly", "recurrence_day_of_month": 15}}]}}

"every day at 9am take vitamins" →
{{"tasks": [{{"action": "add", "description": "take vitamins", "due_date": "today at 9am", "recurrence_pattern": "daily", "recurrence_interval": 1}}]}}

"every month on the 1st pay rent" →
{{"tasks": [{{"action": "add", "description": "pay rent", "due_date": "today at 9am", "recurrence_pattern": "monthly", "recurrence_day_of_month": 1}}]}}

Series Management:
"עצור סדרה 5" →
{{"tasks": [{{"action": "stop_series", "task_id": "5"}}]}}

"השלם סדרה 3" →
{{"tasks": [{{"action": "complete_series", "task_id": "3"}}]}}

Important: 
- Always include "task_id" field when user mentions a specific task number (e.g., "משימה 2", "task 3")!
- When user references a task by description/title (e.g., "באגים של משימות חוזרות הושלם", "buy milk completed", "דחה לקנות חלב למחר"), extract the task description and use "description" field (NOT task_id) - the system will match by task title/description!
- For date-specific queries (asking about tasks for a specific date), ALWAYS include "due_date" in the query action to enable proper database filtering!
- When user asks "what is my task for tomorrow" or "מה המשימות שלי למחר", extract the date and include it in due_date field!
- For general task listing queries (asking to see all tasks), use action "query" with description containing "list all tasks" or similar phrasing
- ALL actions (complete, delete, reschedule, update, query) support both task_id (for numbers) and description (for task titles/descriptions) - choose based on what the user provides!

Message to analyze: {message}"""
        }